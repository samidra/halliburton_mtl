<div class="container-fluid">
  <div class="row p-1">
    <div class="col-12 search_div table_col tabIs_spinnerle-responsive">
      <h4>Rate Chart</h4>
      <div class="d-flex" style="display: flex; align-items: flex-end;">
        <div style="width: 50%">
          <label for="search">Search:</label>
          <input type="text" id="search" [(ngModel)]="searchText" placeholder="Search by Resource, or Any Relevant Information">
        </div>
        <div style="width: 50%;" class="bttn_div">
          <button (click)="addNewResource()" class="yesbtn" *ngIf="!Is_spinner">Add Resource</button>
          <button type="button" class="yesbtn" *ngIf="Is_spinner">
            <div class="spinner"></div>
          </button>
        </div>
      </div>

    </div>
    <div class="col-12 col_table">
      <table class="table-bordered">
        <thead>
          <tr>
            <th rowspan="2" class="monthss">Resource</th>
            <td colspan="31" class="year">
              <i class="bi bi-caret-left-fill me-2" (click)="previousYear()"></i>
              <span class="year-selector">{{ currentYear }}</span>
              <i (click)="nextYear(currentYear)" class="bi bi-caret-right-fill mx-2"></i>
            </td>
          </tr>

          <tr>
            <th class="date" *ngFor="let month of monthsNames">{{ month }}</th>
            <th class="date" *ngIf="currentYear === currentYeara">Action</th>
          </tr>

        </thead>

        <tbody>
          <tr *ngFor="let Item of filteredItems| paginate: { itemsPerPage, currentPage: page } ; let i = index">
            <td class="months">
              <div>{{ Item.resource }}</div>
            </td>
            <td *ngFor="let month of monthsNames; let j = index" [ngClass]="{
               'highlighted': Item.highlightedMonths && Item.highlightedMonths[month]}">
              <input type="text" class="form-control" [(ngModel)]="Item[month.toLowerCase()]"
                [readonly]="currentYear != currentYeara"
                [ngStyle]="currentYear != currentYeara ? {'border': 'none'} : {}"
                (mousedown)="startDrag(((page - 1) * itemsPerPage) + i, month, j)"
                (mousemove)="applyDrag(((page - 1) * itemsPerPage) + i, month, j)"
                (mouseup)="stopDrag(((page - 1) * itemsPerPage) + i, month)" />
            </td>
            <td style="width: 100px; display: flex; justify-content: center;" *ngIf="currentYear === currentYeara">
              <a class="action_a" (click)="updateRate(Item, i)" *ngIf="Is_spinner_save != i">Save Price <i
                  class="bi bi-cloud-download-fill"></i></a>
              <div class="spinner" *ngIf="Is_spinner_save === i"></div>
            </td>

          </tr>
          <tr>

          </tr>
        </tbody>
      </table>
      <div *ngIf="filteredItems?.length === 0" class="no-data-message">
        {{no_data_message}}
      </div>
      <div
        style="display: flex;justify-content: center; margin-top: 5px; font-size: 0.87em !important; font-weight: 600 !important;">
        <pagination-controls (pageChange)="page = $event"></pagination-controls>
      </div>
      <!-- <div class="col-12 mt-2" style="display: flex; justify-content: end;">
        <button class="yesbtn" (click)="updateRate()">Save Price</button>
      </div> -->
    </div>

  </div>
</div>

<div class="loader" *ngIf="isLoading">
  <div class="spinner"></div>
</div>